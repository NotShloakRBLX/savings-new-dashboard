<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Bank • Savings & Checking</title>
<style>
  :root{
    --bg:#0b0b0b;
    --panel:#141414;
    --panel2:#101010;
    --text:#eaeaea;
    --muted:#a9a9a9;
    --border:rgba(255,255,255,.12);
    --tile:rgba(255,255,255,.05);
    --tileBorder:rgba(255,255,255,.10);
    --blue:#0f2b4d;
    --t:.35s cubic-bezier(.2,.8,.2,1);
    --radius:14px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:#000;color:var(--text);
    font:15px -apple-system,BlinkMacSystemFont,"SF Pro Text",Inter,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    font-weight:500;
    -webkit-font-smoothing:auto; text-rendering:optimizeSpeed;
  }
  .app{max-width:430px;height:100svh;margin:0 auto;position:relative;overflow:hidden;background:var(--bg)}
  .views{display:flex;width:200%;height:100%;transition:transform var(--t)}
  .view{width:100%;height:100%;overflow:auto;background:linear-gradient(#0b0b0b,#0a0a0a 60%,#090909)}
  .view::-webkit-scrollbar{width:0;height:0}

  .nav{
    position:sticky;top:0;z-index:5;
    padding:12px 12px 8px;
    background:linear-gradient(180deg,rgba(10,10,10,.96),rgba(10,10,10,.62) 50%,transparent);
    -webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);
  }
  .bankTab{
    display:inline-flex;align-items:center;gap:8px;
    background:var(--blue);border:1px solid rgba(255,255,255,.18);
    color:#fff;padding:10px 12px;border-radius:10px;letter-spacing:.2px;
  }
  .bankTab .dot{width:8px;height:8px;border-radius:50%;background:#6db1ff;opacity:.9}

  /* small settings icon at top-right */
  .settingsBtn{
    position:absolute; right:12px; top:12px;
    width:22px; height:22px; opacity:.95;
    cursor:pointer;
  }
  .settingsBtn img{width:100%;height:100%;display:block}

  .content{padding:12px 12px 28px}

  .balHead{
    display:flex;justify-content:space-between;align-items:flex-end;
    gap:12px;padding:14px;border-radius:12px;background:var(--panel);border:1px solid var(--border)
  }
  .bhCol{min-width:0}
  .label{color:var(--muted);font-size:12px}
  .amt{font-size:30px;line-height:1.05}

  /* hide “Present balance” column on the top cards */
  .presentCol{display:none}

  .apy{display:inline-block;margin-top:10px;padding:6px 10px;border-radius:999px;
       background:var(--tile);border:1px solid var(--tileBorder);font-size:12px}

  .rowBtns{display:flex;gap:10px;margin-top:12px}
  .btn{
    flex:1;padding:14px 16px;border-radius:12px;border:1px solid var(--border);
    background:#efefef;color:#000;font-weight:500;cursor:pointer
  }
  .btn.secondary{background:var(--panel2);color:#fff}

  .swapTile{margin-top:12px;padding:12px 14px;border-radius:12px;background:var(--tile);border:1px solid var(--tileBorder);cursor:pointer}
  .swapTop{display:flex;justify-content:space-between;align-items:center}
  .swapName{color:#dcdcdc}
  .swapAcct{color:#a9a9a9;font-size:12px;margin-top:2px}
  .swapAmt{font-size:18px}

  .section{margin-top:16px}
  .sectionTitle{font-size:16px;color:#dcdcdc;margin:0 2px 8px}
  .list{background:var(--panel);border:1px solid var(--border);border-radius:12px;overflow:hidden}
  .row{display:flex;justify-content:space-between;align-items:center;padding:12px 14px}
  .row + .row{border-top:1px solid var(--tileBorder)}
  .key{color:var(--muted)}
  .val{color:#fff}

  .moreBtnWrap{display:flex;justify-content:center;padding:12px}
  .moreBtn{
    border-radius:999px;border:1px solid var(--tileBorder);background:transparent;
    color:#dcdcdc;padding:10px 14px;font:inherit;cursor:pointer
  }
  .chev{display:inline-block;margin-left:8px;transition:transform var(--t)}
  .open .chev{transform:rotate(180deg)}
  .moreWrap{display:none}
  .list.open .moreWrap{display:block}

  .pos-0 .views{transform:translateX(0%)}        /* Savings */
  .pos-1 .views{transform:translateX(-50%)}      /* Checking */

  .btn:active,.swapTile:active{transform:scale(.98);transition:transform var(--t)}

  /* ===== Center popup (Manage account + subpages) ===== */
  .sheet{position:fixed;inset:0;display:grid;place-items:center;pointer-events:none;z-index:60}
  .sheet .dim{position:absolute;inset:0;background:rgba(0,0,0,.55);opacity:0;transition:opacity var(--t)}
  .sheet .panel{
    width:86%;max-width:360px;background:#151515;border:1px solid var(--tileBorder);
    border-radius:16px;box-shadow:0 18px 50px rgba(0,0,0,.5);
    transform:translateY(8px) scale(.98);opacity:0;transition:transform var(--t),opacity var(--t);overflow:hidden
  }
  .sheet.active{pointer-events:auto}
  .sheet.active .dim{opacity:1}
  .sheet.active .panel{opacity:1;transform:translateY(0) scale(1)}
  .panelHead{padding:14px 16px;border-bottom:1px solid var(--tileBorder);font-weight:700;position:relative}
  .panelBody{padding:14px 16px}
  .mBtn{display:block;width:100%;padding:12px 14px;margin-top:10px;border-radius:12px;border:1px solid var(--border);background:#efefef;color:#000;font-weight:500;cursor:pointer}
  .miniBack{
    position:absolute;left:10px;top:8px;
    padding:6px 10px;border-radius:10px;border:1px solid var(--tileBorder);
    background:#1a1a1a;color:#fff;cursor:pointer;font-size:12px
  }

  .field{margin-top:10px}
  .lab{display:block;margin:0 0 6px;color:#dcdcdc;font-weight:600;font-size:13px}
  .inp, .sel{
    width:100%;padding:12px 12px;border-radius:12px;border:1px solid var(--tileBorder);
    background:#1a1a1a;color:#fff;font:inherit
  }

  .subviews{display:flex;width:300%;transition:transform var(--t)}
  .page{width:100%}
</style>
</head>
<body>
<div class="app pos-0" id="app">
  <div class="views">

    <!-- ===== SAVINGS ===== -->
    <section class="view" id="savings">
      <div class="nav">
        <div class="bankTab"><span class="dot"></span>Bank Accounts</div>
        <div class="settingsBtn" data-ctx="savings" aria-label="Settings"><img src="./settings-icon.png" alt="Settings"></div>
      </div>
      <div class="content">

        <div class="balHead" aria-label="Savings balances">
          <div class="bhCol">
            <div class="label">Available balance</div>
            <div class="amt" id="svAvail">$783.11</div>
          </div>
          <div class="bhCol presentCol" style="text-align:right">
            <div class="label">Present balance</div>
            <div class="amt" id="svPresent">$783.11</div>
          </div>
        </div>

        <div class="apy">184% APR</div>

        <div class="rowBtns">
          <button class="btn">Pay</button>
          <button class="btn secondary" id="toTransfer1">Transfer</button>
        </div>

        <div class="swapTile" id="goChecking" aria-label="Open Checking">
          <div class="swapTop">
            <div>
              <div class="swapName">CHECKING (...2431)</div>
              <div class="swapAcct">Acct 375282431</div>
            </div>
            <div class="swapAmt" id="ckMini">$414.00</div>
          </div>
        </div>

        <div class="section">
          <h3 class="sectionTitle">Account details</h3>
          <div class="list" id="svDetails">
            <div class="row"><div class="key">Account number</div><div class="val">551809124</div></div>
            <div class="row"><div class="key">Routing number</div><div class="val">072000326</div></div>

            <div class="moreWrap">
              <div class="row"><div class="key">Available balance</div><div class="val" id="svAvailRow">$783.11</div></div>
              <div class="row"><div class="key">Present balance</div><div class="val" id="svPresentRow">$783.11</div></div>
              <div class="row"><div class="key">Interest rate</div><div class="val">184% APR</div></div>
              <div class="row"><div class="key">Next interest date</div><div class="val">08/31/2025</div></div>
              <div class="row"><div class="key">Next tax statement date</div><div class="val">08/27/2025</div></div>
            </div>

            <div class="moreBtnWrap">
              <button class="moreBtn" id="svMoreBtn" aria-expanded="false">
                Show more <span class="chev">▾</span>
              </button>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- ===== CHECKING ===== -->
    <section class="view" id="checking">
      <div class="nav">
        <div class="bankTab"><span class="dot"></span>Bank Accounts</div>
        <div class="settingsBtn" data-ctx="checking" aria-label="Settings"><img src="./settings-icon.png" alt="Settings"></div>
      </div>
      <div class="content">

        <div class="balHead" aria-label="Checking balances">
          <div class="bhCol">
            <div class="label">Available balance</div>
            <div class="amt" id="ckAvail">$414.00</div>
          </div>
          <div class="bhCol presentCol" style="text-align:right">
            <div class="label">Present balance</div>
            <div class="amt" id="ckPresent">$414.00</div>
          </div>
        </div>

        <div class="rowBtns">
          <button class="btn">Pay</button>
          <button class="btn secondary" id="toTransfer2">Transfer</button>
        </div>

        <div class="swapTile" id="goSavings" aria-label="Open Savings">
          <div class="swapTop">
            <div>
              <div class="swapName">SAVINGS (...9124)</div>
              <div class="swapAcct">Acct 551809124</div>
            </div>
            <div class="swapAmt" id="svMini">$783.11</div>
          </div>
        </div>

        <div class="section">
          <h3 class="sectionTitle">Account details</h3>
          <div class="list" id="ckDetails">
            <div class="row"><div class="key">Account number</div><div class="val">375282431</div></div>
            <div class="row"><div class="key">Routing number</div><div class="val">072000326</div></div>

            <div class="moreWrap">
              <div class="row"><div class="key">Available balance</div><div class="val" id="ckAvailRow">$414.00</div></div>
              <div class="row"><div class="key">Present balance</div><div class="val" id="ckPresentRow">$414.00</div></div>
              <div class="row"><div class="key">Interest rate</div><div class="val">0.00%</div></div>
              <div class="row"><div class="key">Interest in 2025</div><div class="val">$0.00</div></div>
            </div>

            <div class="moreBtnWrap">
              <button class="moreBtn" id="ckMoreBtn" aria-expanded="false">
                Show more <span class="chev">▾</span>
              </button>
            </div>
          </div>
        </div>

      </div>
    </section>

  </div>
</div>

<!-- Center popup (shared) -->
<div class="sheet" id="settingsSheet" aria-hidden="true">
  <div class="dim"></div>
  <div class="panel" role="dialog" aria-label="Manage account">
    <div class="subviews" id="setViews">
      <!-- Page 0: Home -->
      <div class="page">
        <div class="panelHead">Manage account</div>
        <div class="panelBody">
          <button class="mBtn" id="btnChangeBalance">Change balance</button>
          <button class="mBtn" id="btnAddTxn">Add Transaction</button>
        </div>
      </div>
      <!-- Page 1: Change balance -->
      <div class="page">
        <div class="panelHead">
          <button class="miniBack" id="balBack">Back</button>
          <div style="text-align:center">Change balance</div>
        </div>
        <div class="panelBody">
          <div class="field">
            <label class="lab" for="balAmt">Amount</label>
            <input id="balAmt" class="inp" inputmode="decimal" placeholder="$0.00" />
          </div>
          <button class="mBtn" id="balSave" disabled>Save</button>
        </div>
      </div>
      <!-- Page 2: Add transaction -->
      <div class="page">
        <div class="panelHead">
          <button class="miniBack" id="txnBack">Back</button>
          <div style="text-align:center">Add transaction</div>
        </div>
        <div class="panelBody">
          <div class="field">
            <label class="lab" for="txMerchant">Merchant</label>
            <input id="txMerchant" class="inp" placeholder="e.g., Starbucks" />
          </div>
          <div class="field">
            <label class="lab" for="txAmount">Amount</label>
            <input id="txAmount" class="inp" inputmode="decimal" placeholder="$0.00" />
          </div>
          <div class="field">
            <label class="lab" for="txWhen">Date &amp; time</label>
            <input id="txWhen" class="inp" type="datetime-local" />
          </div>
          <div class="field">
            <label class="lab" for="txStatus">Status</label>
            <select id="txStatus" class="sel">
              <option value="">Choose…</option>
              <option value="Complete">Complete</option>
              <option value="Refunded">Refunded</option>
            </select>
          </div>
          <button class="mBtn" id="txAdd" disabled>Add transaction</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
(() => {
  const app = document.getElementById('app');

  const DEFAULTS = { ver: 2, sv: 783.11, ck: 414.00 };
  const ver = Number(localStorage.getItem('acct_ver') || '0');
  if (ver !== DEFAULTS.ver) {
    localStorage.setItem('sv_bal', String(DEFAULTS.sv));
    localStorage.setItem('ck_bal', String(DEFAULTS.ck));
    localStorage.setItem('acct_ver', String(DEFAULTS.ver));
  }
  const money = n => (Number(n)||0).toLocaleString(undefined,{style:'currency',currency:'USD'});
  const parseMoney = s => {
    const n = parseFloat(String(s||'').replace(/[^\d.]/g,''));
    return isFinite(n) ? Math.round(n*100)/100 : NaN;
  };

  // mutable balances so we can update
  let sv = Number(localStorage.getItem('sv_bal') || DEFAULTS.sv);
  let ck = Number(localStorage.getItem('ck_bal') || DEFAULTS.ck);

  // savings numbers
  const svAvail = document.getElementById('svAvail');
  const svPresent = document.getElementById('svPresent');
  const svMini = document.getElementById('svMini');
  const svAvailRow = document.getElementById('svAvailRow');
  const svPresentRow = document.getElementById('svPresentRow');

  // checking numbers
  const ckAvail = document.getElementById('ckAvail');
  const ckPresent = document.getElementById('ckPresent');
  const ckMini = document.getElementById('ckMini');
  const ckAvailRow = document.getElementById('ckAvailRow');
  const ckPresentRow = document.getElementById('ckPresentRow');

  function render(){
    // savings
    svAvail.textContent = money(sv);
    if (svPresent) svPresent.textContent = money(sv);
    if (svMini) svMini.textContent = money(sv);
    if (svAvailRow) svAvailRow.textContent = money(sv);
    if (svPresentRow) svPresentRow.textContent = money(sv);
    // checking
    ckAvail.textContent = money(ck);
    if (ckPresent) ckPresent.textContent = money(ck);
    if (ckMini) ckMini.textContent = money(ck);
    if (ckAvailRow) ckAvailRow.textContent = money(ck);
    if (ckPresentRow) ckPresentRow.textContent = money(ck);
  }
  render();

  // slide nav
  document.getElementById('goChecking').addEventListener('click', () => { app.className = 'app pos-1'; });
  document.getElementById('goSavings').addEventListener('click',  () => { app.className = 'app pos-0'; });

  // Show more toggles
  function setupMore(listId, btnId){
    const list = document.getElementById(listId);
    const btn  = document.getElementById(btnId);
    btn.addEventListener('click', ()=>{
      const open = list.classList.toggle('open');
      btn.setAttribute('aria-expanded', open ? 'true' : 'false');
      btn.innerHTML = open ? 'Hide details <span class="chev">▾</span>' : 'Show more <span class="chev">▾</span>';
    });
  }
  setupMore('svDetails','svMoreBtn');
  setupMore('ckDetails','ckMoreBtn');

  // keep transfer buttons as no-ops
  document.getElementById('toTransfer1').addEventListener('click', () => {});
  document.getElementById('toTransfer2').addEventListener('click', () => {});

  // ===== Settings modal wiring =====
  const sheet = document.getElementById('settingsSheet');
  const dim = sheet.querySelector('.dim');
  const setViews = document.getElementById('setViews');
  let settingsCtx = null; // 'savings' or 'checking'

  function gotoPage(i){ setViews.style.transform = `translateX(-${i*100}%)`; }
  function openSettings(ctx){
    settingsCtx = ctx;
    sheet.classList.add('active'); sheet.setAttribute('aria-hidden','false');
    gotoPage(0);
    // prefill defaults for forms
    balAmt.value = '';
    txMerchant.value = '';
    txAmount.value = '';
    txWhen.value = new Date(Date.now()-new Date().getTimezoneOffset()*60000).toISOString().slice(0,16);
    txStatus.value = '';
    balSave.disabled = true; txAdd.disabled = true;
  }
  function closeSettings(){ sheet.classList.remove('active'); sheet.setAttribute('aria-hidden','true'); }

  document.querySelectorAll('.settingsBtn').forEach(btn=>{
    btn.addEventListener('click', ()=> openSettings(btn.dataset.ctx));
  });
  dim.addEventListener('click', closeSettings);
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeSettings(); });

  // Home buttons -> pages
  document.getElementById('btnChangeBalance').addEventListener('click', ()=> gotoPage(1));
  document.getElementById('btnAddTxn').addEventListener('click', ()=> gotoPage(2));
  document.getElementById('balBack').addEventListener('click', ()=> gotoPage(0));
  document.getElementById('txnBack').addEventListener('click', ()=> gotoPage(0));

  // ===== Change balance page =====
  const balAmt = document.getElementById('balAmt');
  const balSave = document.getElementById('balSave');

  function formatMoneyField(el){
    const n = parseMoney(el.value);
    if (!isNaN(n)) el.value = n.toLocaleString(undefined,{style:'currency',currency:'USD'});
  }
  balAmt.addEventListener('input', ()=>{
    formatMoneyField(balAmt);
    const v = parseMoney(balAmt.value);
    balSave.disabled = !(isFinite(v) && v>=0);
  });
  balSave.addEventListener('click', ()=>{
    const v = parseMoney(balAmt.value);
    if (!(isFinite(v) && v>=0)) return;
    if (settingsCtx === 'savings'){
      sv = v; localStorage.setItem('sv_bal', String(v));
    } else {
      ck = v; localStorage.setItem('ck_bal', String(v));
    }
    render();
    closeSettings();
  });

  // ===== Add transaction page =====
  const txMerchant = document.getElementById('txMerchant');
  const txAmount   = document.getElementById('txAmount');
  const txWhen     = document.getElementById('txWhen');
  const txStatus   = document.getElementById('txStatus');
  const txAdd      = document.getElementById('txAdd');

  txAmount.addEventListener('input', ()=>{
    formatMoneyField(txAmount);
    validateTxn();
  });
  [txMerchant, txWhen, txStatus].forEach(el=> el.addEventListener('input', validateTxn));

  function validateTxn(){
    const ok = txMerchant.value.trim() &&
               isFinite(parseMoney(txAmount.value)) &&
               txWhen.value &&
               (txStatus.value==='Complete' || txStatus.value==='Refunded');
    txAdd.disabled = !ok;
  }

  txAdd.addEventListener('click', ()=>{
    const amt = parseMoney(txAmount.value);
    if (txAdd.disabled || !isFinite(amt)) return;
    const key = settingsCtx === 'savings' ? 'sv_txns' : 'ck_txns';
    const list = JSON.parse(localStorage.getItem(key) || '[]');
    list.push({
      id:'t_'+Math.random().toString(36).slice(2,9),
      merchant: txMerchant.value.trim(),
      amount: amt,
      iso: new Date(txWhen.value).toISOString(),
      status: txStatus.value
    });
    localStorage.setItem(key, JSON.stringify(list));
    closeSettings();
  });
})();
</script>
</body>
</html>
